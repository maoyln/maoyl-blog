<h1 id="yaml语言教程">yaml语言教程</h1>

<h2 id="简介">简介</h2>

<p>YAML 是 “YAML Ain’t a Markup Language”（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是：”Yet Another Markup Language”（仍是一种标记语言）。</p>

<!-- more -->

<p>YAML 的语法和其他高级语言类似，并且可以简单表达清单、散列表，标量等数据形态。它使用空白符号缩进和大量依赖外观的特色，特别<strong>适合用来表达或编辑数据结构、各种配置文件、倾印调试内容、文件大纲</strong>（例如：许多电子邮件标题格式和YAML非常接近）。</p>

<p>YAML 的配置文件后缀为 <strong>.yml</strong>，如：<strong>runoob.yml</strong> 。</p>

<blockquote>
  <p>yaml常用来用作配置文件，和json类似</p>
</blockquote>

<h2 id="基本语法">基本语法</h2>

<ul>
  <li>
    <p>大小写敏感</p>
  </li>
  <li>
    <p>使用缩进表示层级关系</p>
  </li>
  <li>
    <p>缩进不允许使用tab，只允许空格</p>
  </li>
  <li>
    <p>缩进的空格数不重要，只要相同层级的元素左对齐即可</p>
  </li>
  <li>
    <p>’#’表示注释</p>
  </li>
</ul>

<h2 id="数据类型">数据类型</h2>

<p>YAML 支持以下几种数据类型：</p>

<ul>
  <li><strong>对象</strong>：键值对的集合，又称为映射（mapping）/ 哈希（hashes） / 字典（dictionary）</li>
  <li><strong>数组</strong>：一组按次序排列的值，又称为序列（sequence） / 列表（list）</li>
  <li><strong>纯量</strong>（scalars）：单个的、不可再分的值</li>
</ul>

<h2 id="yaml-对象">YAML 对象</h2>

<p>对象的几种表示形式：</p>

<p>1、对象键值对使用冒号结构表示 <strong>key: value</strong>，冒号后面要加一个空格。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">key</span><span class="pi">:</span> <span class="s">value</span>
</code></pre></div></div>

<p>2、也可以使用 <strong>key:{key1: value1, key2: value2, …}</strong>。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">key:{child-key1:value1,child-key2:value2}</span>
</code></pre></div></div>

<p>3、还可以使用缩进表示层级关系；</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">key</span><span class="pi">:</span> 
    <span class="na">child-key1</span><span class="pi">:</span> <span class="s">value1</span>
    <span class="na">child-key2</span><span class="pi">:</span> <span class="s">value2</span>
</code></pre></div></div>

<p>同2，只是表示形式不同。</p>

<p>4、较为复杂的对象格式，可以使用问号加一个空格代表一个复杂的 key，配合一个冒号加一个空格代表一个 value：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">?</span>  
    <span class="pi">-</span> <span class="s">complexkey1</span>
    <span class="pi">-</span> <span class="s">complexkey2</span>
<span class="pi">:</span>
    <span class="pi">-</span> <span class="s">complexvalue1</span>
    <span class="pi">-</span> <span class="s">complexvalue2</span>
</code></pre></div></div>

<p>意思即对象的属性是一个数组 [complexkey1,complexkey2]，对应的值也是一个数组 [complexvalue1,complexvalue2]</p>

<h2 id="yaml-数组">YAML 数组</h2>

<p>以 <strong>-</strong> 开头的行表示构成一个数组：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="s">A</span>
<span class="pi">-</span> <span class="s">B</span>
<span class="pi">-</span> <span class="s">C</span>
</code></pre></div></div>

<p>YAML 支持多维数组，可以使用行内表示：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">key</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">value1</span><span class="pi">,</span> <span class="nv">value2</span><span class="pi">,</span> <span class="nv">...</span><span class="pi">]</span>
</code></pre></div></div>

<p>数据结构的子成员是一个数组，则可以在该项下面缩进一个空格。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span>
 <span class="pi">-</span> <span class="s">A</span>
 <span class="pi">-</span> <span class="s">B</span>
 <span class="pi">-</span> <span class="s">C</span>
</code></pre></div></div>

<p>一个相对复杂的例子：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">companies</span><span class="pi">:</span>
    <span class="pi">-</span>
        <span class="na">id</span><span class="pi">:</span> <span class="m">1</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">company1</span>
        <span class="na">price</span><span class="pi">:</span> <span class="s">200W</span>
    <span class="pi">-</span>
        <span class="na">id</span><span class="pi">:</span> <span class="m">2</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">company2</span>
        <span class="na">price</span><span class="pi">:</span> <span class="s">500W</span>
</code></pre></div></div>

<p>意思是 companies 属性是一个数组，每一个数组元素又是由 id、name、price 三个属性构成。</p>

<p>数组也可以使用流式(flow)的方式表示：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">companies</span><span class="pi">:</span> <span class="pi">[{</span><span class="nv">id</span><span class="pi">:</span> <span class="nv">1</span><span class="pi">,</span><span class="nv">name</span><span class="pi">:</span> <span class="nv">company1</span><span class="pi">,</span><span class="nv">price</span><span class="pi">:</span> <span class="nv">200W</span><span class="pi">},{</span><span class="nv">id</span><span class="pi">:</span> <span class="nv">2</span><span class="pi">,</span><span class="nv">name</span><span class="pi">:</span> <span class="nv">company2</span><span class="pi">,</span><span class="nv">price</span><span class="pi">:</span> <span class="nv">500W</span><span class="pi">}]</span>
</code></pre></div></div>

<h2 id="复合结构对象和数组组合">复合结构（对象和数组组合）</h2>

<p>数组和对象可以构成复合结构，例：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">languages</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">Ruby</span>
  <span class="pi">-</span> <span class="s">Perl</span>
  <span class="pi">-</span> <span class="s">Python</span> 
<span class="na">websites</span><span class="pi">:</span>
  <span class="na">YAML</span><span class="pi">:</span> <span class="s">yaml.org</span> 
  <span class="na">Ruby</span><span class="pi">:</span> <span class="s">ruby-lang.org</span> 
  <span class="na">Python</span><span class="pi">:</span> <span class="s">python.org</span> 
  <span class="na">Perl</span><span class="pi">:</span> <span class="s">use.perl.org</span>
</code></pre></div></div>

<p>转换为 js 为：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">{</span> 
  <span class="nv">languages</span><span class="pi">:</span> <span class="pi">[</span> <span class="s1">'</span><span class="s">Ruby'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">Perl'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">Python'</span><span class="pi">],</span>
  <span class="nv">websites</span><span class="pi">:</span> <span class="pi">{</span>
    <span class="nv">YAML</span><span class="pi">:</span> <span class="s1">'</span><span class="s">yaml.org'</span><span class="pi">,</span>
    <span class="nv">Ruby</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ruby-lang.org'</span><span class="pi">,</span>
    <span class="nv">Python</span><span class="pi">:</span> <span class="s1">'</span><span class="s">python.org'</span><span class="pi">,</span>
    <span class="nv">Perl</span><span class="pi">:</span> <span class="s1">'</span><span class="s">use.perl.org'</span> 
  <span class="pi">}</span> 
<span class="pi">}</span>
</code></pre></div></div>

<h2 id="纯量">纯量</h2>

<p>纯量是最基本的，不可再分的值，包括：</p>

<ul>
  <li>字符串</li>
  <li>布尔值</li>
  <li>整数</li>
  <li>浮点数</li>
  <li>Null</li>
  <li>时间</li>
  <li>日期</li>
</ul>

<p>使用一个例子来快速了解纯量的基本使用：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">boolean</span><span class="pi">:</span> <span class="c1"># 布尔值</span>
    <span class="pi">-</span> <span class="s">TRUE</span>  <span class="c1">#true,True都可以</span>
    <span class="pi">-</span> <span class="s">FALSE</span>  <span class="c1">#false，False都可以</span>
<span class="na">float</span><span class="pi">:</span> <span class="c1"># 浮点数</span>
    <span class="pi">-</span> <span class="m">3.14</span>
    <span class="pi">-</span> <span class="s">6.8523015e+5</span>  <span class="c1">#可以使用科学计数法</span>
<span class="na">int</span><span class="pi">:</span> <span class="c1"># 整数</span>
    <span class="pi">-</span> <span class="m">123</span>
    <span class="pi">-</span> <span class="s">0b1010_0111_0100_1010_1110</span>    <span class="c1">#二进制表示</span>
<span class="na">null</span><span class="pi">:</span> <span class="c1"># Null</span>
    <span class="na">nodeName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">node'</span>
    <span class="na">parent</span><span class="pi">:</span> <span class="s">~</span>  <span class="c1">#使用~表示null</span>
<span class="na">string</span><span class="pi">:</span> <span class="c1"># 字符串</span>
    <span class="pi">-</span> <span class="s">哈哈</span> <span class="c1"># 字符串默认不使用引号表示</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">Hello</span><span class="nv"> </span><span class="s">world'</span>  <span class="c1">#可以使用双引号或者单引号包裹特殊字符</span>
    <span class="pi">-</span> <span class="s">newline</span>
      <span class="s">newline2</span>    <span class="c1">#字符串可以拆成多行，每一行会被转化成一个空格</span>
<span class="na">date</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">2018-02-17</span>    <span class="c1">#日期必须使用ISO 8601格式，即yyyy-MM-dd</span>
<span class="na">datetime</span><span class="pi">:</span> 
    <span class="pi">-</span>  <span class="s">2018-02-17T15:02:31+08:00</span>    <span class="c1">#时间使用ISO 8601格式，时间和日期之间使用T连接，最后使用+代表时区</span>
</code></pre></div></div>

<p>多行字符串可以使用<code class="language-plaintext highlighter-rouge">|</code>保留换行符，也可以使用<code class="language-plaintext highlighter-rouge">&gt;</code>折叠换行。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">this</span><span class="pi">:</span> <span class="pi">|</span>
  <span class="s">Foo</span>
  <span class="s">Bar</span>
<span class="na">that</span><span class="pi">:</span> <span class="pi">&gt;</span>
  <span class="s">Foo</span>
  <span class="s">Bar</span>
</code></pre></div></div>

<p>转为js代码如下。</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">this:</span><span class="w"> </span><span class="err">'Foo\nBar\n'</span><span class="p">,</span><span class="w"> </span><span class="err">that:</span><span class="w"> </span><span class="err">'Foo</span><span class="w"> </span><span class="err">Bar\n'</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">+</code>表示保留文字块末尾的换行，<code class="language-plaintext highlighter-rouge">-</code>表示删除字符串末尾的换行。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">s1</span><span class="pi">:</span> <span class="pi">|</span>
  <span class="s">Foo</span>
 
<span class="na">s2</span><span class="pi">:</span> <span class="pi">|+</span>
  <span class="s">Foo</span>
 
 
<span class="na">s3</span><span class="pi">:</span> <span class="pi">|-</span>
  <span class="s">Foo</span>
</code></pre></div></div>

<p>转为json代码如下</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">s</span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="err">'Foo\n'</span><span class="p">,</span><span class="w"> </span><span class="err">s</span><span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="err">'Foo\n\n\n'</span><span class="p">,</span><span class="w"> </span><span class="err">s</span><span class="mi">3</span><span class="err">:</span><span class="w"> </span><span class="err">'Foo'</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>字符串之中可以插入 HTML 标记。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">message</span><span class="pi">:</span> <span class="pi">|</span>
  <span class="s">&lt;p style="color: red"&gt;</span>
    <span class="s">段落</span>
  <span class="s">&lt;/p&gt;</span>
</code></pre></div></div>

<h2 id="转换数据格式">转换数据格式</h2>

<p>允许使用两个感叹号，强制转换数据类型。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">e</span><span class="pi">:</span> <span class="kt">!!str</span> <span class="m">123</span>
<span class="na">f</span><span class="pi">:</span> <span class="kt">!!str</span> <span class="no">true</span>
</code></pre></div></div>

<p>转换js结果同：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">e:</span><span class="w"> </span><span class="err">'</span><span class="mi">123</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">f:</span><span class="w"> </span><span class="err">'</span><span class="kc">true</span><span class="err">'</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="锚点引用">锚点引用</h2>

<p><strong>&amp;</strong> 锚点和&lt; span class=”marked”&gt;* 别名，可以用来引用:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">defaults</span><span class="pi">:</span> <span class="nl">&amp;defaults</span> <span class="c1"># 添加锚点</span>
  <span class="na">adapter</span><span class="pi">:</span>  <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span>     <span class="s">localhost</span>

<span class="na">development</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">myapp_development</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span> <span class="c1"># &lt;&lt;表示合并，*引用锚点</span>

<span class="na">test</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">myapp_test</span>
  <span class="na">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span> <span class="c1"># &lt;&lt;表示合并，*引用锚点</span>
</code></pre></div></div>

<p>相当于:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">defaults</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span>  <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span>     <span class="s">localhost</span>

<span class="na">development</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">myapp_development</span>
  <span class="na">adapter</span><span class="pi">:</span>  <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span>     <span class="s">localhost</span>

<span class="na">test</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">myapp_test</span>
  <span class="na">adapter</span><span class="pi">:</span>  <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span>     <span class="s">localhost</span>
</code></pre></div></div>

<p><strong>&amp;</strong> 用来建立锚点（defaults），<strong>«</strong> 表示合并到当前数据，***** 用来引用锚点。</p>

<p>下面是另一个例子:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="nl">&amp;showell</span> <span class="s">Steve</span> 
<span class="pi">-</span> <span class="s">Clark</span> 
<span class="pi">-</span> <span class="s">Brian</span> 
<span class="pi">-</span> <span class="s">Oren</span> 
<span class="pi">-</span> <span class="nv">*showell</span> 
</code></pre></div></div>

<p>转为js代码如下:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">[</span> <span class="s1">'</span><span class="s">Steve'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">Clark'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">Brian'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">Oren'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">Steve'</span> <span class="pi">]</span>
</code></pre></div></div>

<blockquote>
  <p>参考：</p>

  <ul>
    <li>yaml官网：<a href="https://yaml.org/">https://yaml.org/</a></li>
    <li>yaml与js的转换demo：<a href="http://nodeca.github.io/js-yaml/">http://nodeca.github.io/js-yaml/</a></li>
    <li>菜鸟教程：<a href="https://www.ruanyifeng.com/blog/2016/07/yaml.html">https://www.ruanyifeng.com/blog/2016/07/yaml.html</a></li>
  </ul>
</blockquote>
