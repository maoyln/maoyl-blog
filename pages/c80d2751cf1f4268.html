<h1 id="vue中的scoped和scoped穿透">Vue中的scoped和scoped穿透</h1>

<h2 id="什么是scoped">什么是scoped？</h2>

<p>在Vue文件中的style标签上有一个特殊的属性<code class="language-plaintext highlighter-rouge">scoped</code>。当一个style标签拥有<code class="language-plaintext highlighter-rouge">scoped</code>属性时候，它的css样式只能用于当前的Vue组件，可以使组件的样式不相互污染。如果一个项目的所有style标签都加上了<code class="language-plaintext highlighter-rouge">scoped</code>属性，相当于实现了样式的模块化。
<!-- more --></p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;style </span><span class="na">lang=</span><span class="s">"less"</span> <span class="na">scoped</span><span class="nt">&gt;</span>
</code></pre></div></div>

<h2 id="scoped的实现原理">scoped的实现原理</h2>

<p>Vue中的<code class="language-plaintext highlighter-rouge">scoped</code>属性的效果主要是通过<code class="language-plaintext highlighter-rouge">PostCss</code>实现的。以下是转译前后的代码:</p>

<p>转译前:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;style </span><span class="na">lang=</span><span class="s">"less"</span> <span class="na">scoped</span><span class="nt">&gt;</span>
    <span class="nc">.example</span><span class="p">{</span>
        <span class="nl">color</span><span class="p">:</span><span class="no">red</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;template&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"example"</span><span class="nt">&gt;</span>scoped测试案例<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div>

<p>转译后:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;style&gt;</span>
    <span class="nc">.example</span><span class="o">[</span><span class="nt">data-v-5558831a</span><span class="o">]</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;template&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"example"</span> <span class="na">data-v-5558831a</span><span class="nt">&gt;</span>scoped测试案例<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">PostCSS</code>给一个组件中的所有DOM添加了一个独一无二的动态属性，给css选择器额外添加一个对应的属性选择器，来选择组件中的DOM,这种做法使得样式只作用于含有该属性的DOM元素(组件内部的DOM)。</p>

<p><strong>总结：<code class="language-plaintext highlighter-rouge">scoped</code>的渲染规则</strong>：</p>

<ol>
  <li>给HTML的DOM节点添加一个不重复的data属性(例如: data-v-5558831a)来唯一标识这个DOM 元素</li>
  <li>在每句css选择器的末尾(编译后生成的css语句)加一个当前组件的data属性选择器(例如：[data-v-5558831a])来私有化样式</li>
</ol>

<h2 id="scoped穿透">scoped穿透</h2>

<p><code class="language-plaintext highlighter-rouge">scoped</code>看起来很好用，当时在Vue项目中，当我们引入第三方组件库时(如使用vue-awesome-swiper实现移动端轮播)，需要在局部组件中修改第三方组件库的样式，而又不想去除<code class="language-plaintext highlighter-rouge">scoped</code>属性造成组件之间的样式覆盖。这时我们可以通过特殊的方式穿透scoped。</p>

<p><strong>stylus的样式穿透 使用 <code class="language-plaintext highlighter-rouge">&gt;&gt;&gt;</code></strong></p>

<pre><code class="language-stylus">外层 &gt;&gt;&gt; 子组件元素
  样式
        
.wrapper &gt;&gt;&gt; .swiper-pagination-bullet-active
  background: #fff
</code></pre>

<p><strong>sass和less的样式穿透 使用<code class="language-plaintext highlighter-rouge">/deep/</code></strong></p>

<pre><code class="language-less">外层 /deep/ 子组件元素 {
    样式
}
.wrapper /deep/ .swiper-pagination-bullet-active{
    background: #fff;
}
</code></pre>

<h2 id="在组件中修改第三方组件库样式的其它方法">在组件中修改第三方组件库样式的其它方法</h2>

<p>上面我们介绍了在使用<code class="language-plaintext highlighter-rouge">scoped</code> 属性时，通过<code class="language-plaintext highlighter-rouge">scoped</code>穿透的方式修改引入第三方组件库样式的方法，下面我们介绍其它方式来修改引入第三方组件库的样式：</p>

<ul>
  <li>
    <p>在vue组件中不使用<code class="language-plaintext highlighter-rouge">scoped</code>属性</p>
  </li>
  <li>
    <p>在vue组建中使用两个style标签，一个加上<code class="language-plaintext highlighter-rouge">scoped</code>属性，一个不加<code class="language-plaintext highlighter-rouge">scoped</code>属性，把需要覆盖的css样式写在不加<code class="language-plaintext highlighter-rouge">scoped</code>属性的style标签里</p>
  </li>
  <li>
    <p>建立一个reset.css(基础全局样式)文件，里面写覆盖的css样式，在入口文件main.js 中引入</p>
  </li>
</ul>
