<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Iterator 和 for-of 循环 | Maoyl&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/maoyl-blog/img/favicon.ico">
    <link href="/maoyl-blog/baidu_verify_code-4axo0NWIC9.html">
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="maoyl,maoyln,前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/maoyl-blog/assets/css/0.styles.f1c5246f.css" as="style"><link rel="preload" href="/maoyl-blog/assets/js/app.80208eb3.js" as="script"><link rel="preload" href="/maoyl-blog/assets/js/2.4c6434db.js" as="script"><link rel="preload" href="/maoyl-blog/assets/js/124.56ac94eb.js" as="script"><link rel="prefetch" href="/maoyl-blog/assets/js/10.dd24e7eb.js"><link rel="prefetch" href="/maoyl-blog/assets/js/100.4102e9cc.js"><link rel="prefetch" href="/maoyl-blog/assets/js/101.1e7b668c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/102.4cef19a9.js"><link rel="prefetch" href="/maoyl-blog/assets/js/103.c72e9b81.js"><link rel="prefetch" href="/maoyl-blog/assets/js/104.3a9f518d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/105.df05339d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/106.ce4e0afb.js"><link rel="prefetch" href="/maoyl-blog/assets/js/107.c0c67ec1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/108.cdbe0fc8.js"><link rel="prefetch" href="/maoyl-blog/assets/js/109.3d900776.js"><link rel="prefetch" href="/maoyl-blog/assets/js/11.f5fbbe7d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/110.d2c67994.js"><link rel="prefetch" href="/maoyl-blog/assets/js/111.52db5de2.js"><link rel="prefetch" href="/maoyl-blog/assets/js/112.96647a6b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/113.fc17f65f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/114.820fa3a6.js"><link rel="prefetch" href="/maoyl-blog/assets/js/115.5512da96.js"><link rel="prefetch" href="/maoyl-blog/assets/js/116.2ee110da.js"><link rel="prefetch" href="/maoyl-blog/assets/js/117.814a9072.js"><link rel="prefetch" href="/maoyl-blog/assets/js/118.f9f30216.js"><link rel="prefetch" href="/maoyl-blog/assets/js/119.1766cb91.js"><link rel="prefetch" href="/maoyl-blog/assets/js/12.c79ee674.js"><link rel="prefetch" href="/maoyl-blog/assets/js/120.c36d0706.js"><link rel="prefetch" href="/maoyl-blog/assets/js/121.d7f01999.js"><link rel="prefetch" href="/maoyl-blog/assets/js/122.68f4a200.js"><link rel="prefetch" href="/maoyl-blog/assets/js/123.e1ad7276.js"><link rel="prefetch" href="/maoyl-blog/assets/js/125.3ab2f3fb.js"><link rel="prefetch" href="/maoyl-blog/assets/js/126.95f97ede.js"><link rel="prefetch" href="/maoyl-blog/assets/js/127.af70dc24.js"><link rel="prefetch" href="/maoyl-blog/assets/js/128.318d210b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/129.91770912.js"><link rel="prefetch" href="/maoyl-blog/assets/js/13.7edc067b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/130.6bce2a4b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/131.7d9fc496.js"><link rel="prefetch" href="/maoyl-blog/assets/js/132.ec97acac.js"><link rel="prefetch" href="/maoyl-blog/assets/js/133.b975485b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/134.0970c478.js"><link rel="prefetch" href="/maoyl-blog/assets/js/135.6d4653ce.js"><link rel="prefetch" href="/maoyl-blog/assets/js/136.227ce084.js"><link rel="prefetch" href="/maoyl-blog/assets/js/137.5ab18b5b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/138.69e57f76.js"><link rel="prefetch" href="/maoyl-blog/assets/js/139.2ed4e4d1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/14.2ca6098b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/140.8f91bd73.js"><link rel="prefetch" href="/maoyl-blog/assets/js/141.5293bb6d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/142.e0e0ad32.js"><link rel="prefetch" href="/maoyl-blog/assets/js/143.77920562.js"><link rel="prefetch" href="/maoyl-blog/assets/js/144.c8fb6ee2.js"><link rel="prefetch" href="/maoyl-blog/assets/js/145.91db30c1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/146.c4254c3b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/147.f7553548.js"><link rel="prefetch" href="/maoyl-blog/assets/js/148.124b8534.js"><link rel="prefetch" href="/maoyl-blog/assets/js/149.00608212.js"><link rel="prefetch" href="/maoyl-blog/assets/js/15.aa71c54f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/150.0f26feaa.js"><link rel="prefetch" href="/maoyl-blog/assets/js/151.2e6b6f0f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/152.43f47a38.js"><link rel="prefetch" href="/maoyl-blog/assets/js/153.4829a7d4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/154.a8288f5a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/155.00a6d55b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/156.e563627b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/157.b75b7539.js"><link rel="prefetch" href="/maoyl-blog/assets/js/158.04634669.js"><link rel="prefetch" href="/maoyl-blog/assets/js/159.a7f28aa2.js"><link rel="prefetch" href="/maoyl-blog/assets/js/16.c292c423.js"><link rel="prefetch" href="/maoyl-blog/assets/js/160.00ff3142.js"><link rel="prefetch" href="/maoyl-blog/assets/js/161.d20ad857.js"><link rel="prefetch" href="/maoyl-blog/assets/js/162.0380c334.js"><link rel="prefetch" href="/maoyl-blog/assets/js/163.f725882c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/164.2fffdc0f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/165.5d5da621.js"><link rel="prefetch" href="/maoyl-blog/assets/js/166.86dca698.js"><link rel="prefetch" href="/maoyl-blog/assets/js/167.42e05f41.js"><link rel="prefetch" href="/maoyl-blog/assets/js/168.15632d3d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/169.a330241b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/17.edbd2266.js"><link rel="prefetch" href="/maoyl-blog/assets/js/170.d6eb2e46.js"><link rel="prefetch" href="/maoyl-blog/assets/js/171.98a572c3.js"><link rel="prefetch" href="/maoyl-blog/assets/js/172.82ad66bf.js"><link rel="prefetch" href="/maoyl-blog/assets/js/173.07869655.js"><link rel="prefetch" href="/maoyl-blog/assets/js/174.7ac31cec.js"><link rel="prefetch" href="/maoyl-blog/assets/js/175.f36aebd5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/176.00dbf744.js"><link rel="prefetch" href="/maoyl-blog/assets/js/177.ea637a7f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/178.3ef93cd8.js"><link rel="prefetch" href="/maoyl-blog/assets/js/179.4d3434f1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/18.5dc3eb57.js"><link rel="prefetch" href="/maoyl-blog/assets/js/180.6218e06e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/181.3e4f1b5b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/182.ca294dfb.js"><link rel="prefetch" href="/maoyl-blog/assets/js/183.3e55c10e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/184.870750ab.js"><link rel="prefetch" href="/maoyl-blog/assets/js/185.6351644d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/186.a6ba631e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/187.dfb0c095.js"><link rel="prefetch" href="/maoyl-blog/assets/js/188.132c7d81.js"><link rel="prefetch" href="/maoyl-blog/assets/js/189.c56cf4bc.js"><link rel="prefetch" href="/maoyl-blog/assets/js/19.33307e18.js"><link rel="prefetch" href="/maoyl-blog/assets/js/190.873c6671.js"><link rel="prefetch" href="/maoyl-blog/assets/js/191.264601a4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/192.c495a94e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/193.b74404e4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/194.2248c8af.js"><link rel="prefetch" href="/maoyl-blog/assets/js/195.82d62141.js"><link rel="prefetch" href="/maoyl-blog/assets/js/196.9f615acf.js"><link rel="prefetch" href="/maoyl-blog/assets/js/197.354b64e8.js"><link rel="prefetch" href="/maoyl-blog/assets/js/198.5c0a49cd.js"><link rel="prefetch" href="/maoyl-blog/assets/js/199.81b43aec.js"><link rel="prefetch" href="/maoyl-blog/assets/js/20.bae5b81b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/200.1911fa61.js"><link rel="prefetch" href="/maoyl-blog/assets/js/201.486076e5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/202.56225c71.js"><link rel="prefetch" href="/maoyl-blog/assets/js/203.ad700f86.js"><link rel="prefetch" href="/maoyl-blog/assets/js/204.ae65dcbb.js"><link rel="prefetch" href="/maoyl-blog/assets/js/205.2c7b5ec2.js"><link rel="prefetch" href="/maoyl-blog/assets/js/206.442cf82c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/207.b8eea082.js"><link rel="prefetch" href="/maoyl-blog/assets/js/208.670459ac.js"><link rel="prefetch" href="/maoyl-blog/assets/js/209.4372354c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/21.542fd57d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/210.6db56cd0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/211.3ee92081.js"><link rel="prefetch" href="/maoyl-blog/assets/js/212.d23dfffa.js"><link rel="prefetch" href="/maoyl-blog/assets/js/213.0c5003b3.js"><link rel="prefetch" href="/maoyl-blog/assets/js/214.f5625531.js"><link rel="prefetch" href="/maoyl-blog/assets/js/215.7a5abc9f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/216.255885a7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/217.abd96f13.js"><link rel="prefetch" href="/maoyl-blog/assets/js/218.a98796cc.js"><link rel="prefetch" href="/maoyl-blog/assets/js/219.be038f26.js"><link rel="prefetch" href="/maoyl-blog/assets/js/22.3dc4d470.js"><link rel="prefetch" href="/maoyl-blog/assets/js/220.bbb2e8b7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/221.6aab7468.js"><link rel="prefetch" href="/maoyl-blog/assets/js/222.185128c7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/223.55eb5bf3.js"><link rel="prefetch" href="/maoyl-blog/assets/js/224.a2f1ae31.js"><link rel="prefetch" href="/maoyl-blog/assets/js/225.d0851c9b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/226.b742d595.js"><link rel="prefetch" href="/maoyl-blog/assets/js/227.584d2664.js"><link rel="prefetch" href="/maoyl-blog/assets/js/228.581b15c5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/229.a25e4516.js"><link rel="prefetch" href="/maoyl-blog/assets/js/23.d5326505.js"><link rel="prefetch" href="/maoyl-blog/assets/js/230.65ab64a4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/231.11c0bd44.js"><link rel="prefetch" href="/maoyl-blog/assets/js/232.799e3334.js"><link rel="prefetch" href="/maoyl-blog/assets/js/233.14359d90.js"><link rel="prefetch" href="/maoyl-blog/assets/js/234.7cef55f0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/235.488ea483.js"><link rel="prefetch" href="/maoyl-blog/assets/js/236.b5d1b8f0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/237.8ec68b67.js"><link rel="prefetch" href="/maoyl-blog/assets/js/238.ec6ac4ee.js"><link rel="prefetch" href="/maoyl-blog/assets/js/239.be47cc9c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/24.108035e4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/240.b55698a5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/241.46a9e652.js"><link rel="prefetch" href="/maoyl-blog/assets/js/242.30705f63.js"><link rel="prefetch" href="/maoyl-blog/assets/js/243.2f14fae4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/244.e167c951.js"><link rel="prefetch" href="/maoyl-blog/assets/js/245.eb81ada8.js"><link rel="prefetch" href="/maoyl-blog/assets/js/246.01767168.js"><link rel="prefetch" href="/maoyl-blog/assets/js/247.4067865b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/248.1dce3104.js"><link rel="prefetch" href="/maoyl-blog/assets/js/249.f1fff648.js"><link rel="prefetch" href="/maoyl-blog/assets/js/25.89e6f77c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/250.63507269.js"><link rel="prefetch" href="/maoyl-blog/assets/js/251.ff585f0a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/252.1a3b90b9.js"><link rel="prefetch" href="/maoyl-blog/assets/js/253.ba94a2f7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/254.3f43851b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/255.b0f78cde.js"><link rel="prefetch" href="/maoyl-blog/assets/js/256.b9ebb627.js"><link rel="prefetch" href="/maoyl-blog/assets/js/257.5e6f3a8d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/258.4c5d4fd7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/259.5b20f196.js"><link rel="prefetch" href="/maoyl-blog/assets/js/26.a329e86a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/260.c65d234b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/261.6716ad5d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/262.bb73cf23.js"><link rel="prefetch" href="/maoyl-blog/assets/js/263.71ab241b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/264.e3048b4c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/265.a2259962.js"><link rel="prefetch" href="/maoyl-blog/assets/js/266.277e04dd.js"><link rel="prefetch" href="/maoyl-blog/assets/js/267.d29725b5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/268.27e116e1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/269.07dcb3af.js"><link rel="prefetch" href="/maoyl-blog/assets/js/27.c420f4d0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/270.8a92d485.js"><link rel="prefetch" href="/maoyl-blog/assets/js/271.6aa15b5a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/272.0a702439.js"><link rel="prefetch" href="/maoyl-blog/assets/js/273.e3df5573.js"><link rel="prefetch" href="/maoyl-blog/assets/js/274.4235c07e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/275.c63a96f8.js"><link rel="prefetch" href="/maoyl-blog/assets/js/276.f6f2a750.js"><link rel="prefetch" href="/maoyl-blog/assets/js/277.26c04069.js"><link rel="prefetch" href="/maoyl-blog/assets/js/278.40f385c4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/279.c850e4ac.js"><link rel="prefetch" href="/maoyl-blog/assets/js/28.4c4ada3e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/280.1d4540af.js"><link rel="prefetch" href="/maoyl-blog/assets/js/281.c19a9856.js"><link rel="prefetch" href="/maoyl-blog/assets/js/282.5ea927aa.js"><link rel="prefetch" href="/maoyl-blog/assets/js/283.e7da6bf7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/284.f1c0920a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/285.ab506cfd.js"><link rel="prefetch" href="/maoyl-blog/assets/js/286.37ea5d33.js"><link rel="prefetch" href="/maoyl-blog/assets/js/287.172986aa.js"><link rel="prefetch" href="/maoyl-blog/assets/js/288.22843ea2.js"><link rel="prefetch" href="/maoyl-blog/assets/js/289.3600efce.js"><link rel="prefetch" href="/maoyl-blog/assets/js/29.a7a46a56.js"><link rel="prefetch" href="/maoyl-blog/assets/js/290.a2f0879c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/291.485d547e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/292.1c6105e0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/293.4f25dd1a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/294.655132ef.js"><link rel="prefetch" href="/maoyl-blog/assets/js/295.f8f20601.js"><link rel="prefetch" href="/maoyl-blog/assets/js/296.7b208618.js"><link rel="prefetch" href="/maoyl-blog/assets/js/297.926b47cf.js"><link rel="prefetch" href="/maoyl-blog/assets/js/298.3747d95c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/299.fd1a3f33.js"><link rel="prefetch" href="/maoyl-blog/assets/js/3.602b0124.js"><link rel="prefetch" href="/maoyl-blog/assets/js/30.727432f1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/300.f8b17cd4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/301.1f35deb5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/302.200d1e5a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/303.1a81529a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/304.d3cec84b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/305.f4e09a54.js"><link rel="prefetch" href="/maoyl-blog/assets/js/306.4f12c06c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/307.d5249170.js"><link rel="prefetch" href="/maoyl-blog/assets/js/308.f74dba0d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/309.886e6e59.js"><link rel="prefetch" href="/maoyl-blog/assets/js/31.cabbed89.js"><link rel="prefetch" href="/maoyl-blog/assets/js/310.e3c3fb0b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/311.618668c8.js"><link rel="prefetch" href="/maoyl-blog/assets/js/312.01b8ca23.js"><link rel="prefetch" href="/maoyl-blog/assets/js/313.9c4fd3e2.js"><link rel="prefetch" href="/maoyl-blog/assets/js/314.8eee6898.js"><link rel="prefetch" href="/maoyl-blog/assets/js/315.bec39479.js"><link rel="prefetch" href="/maoyl-blog/assets/js/32.6912e346.js"><link rel="prefetch" href="/maoyl-blog/assets/js/33.9b81a07b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/34.2ae1b13c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/35.339593ec.js"><link rel="prefetch" href="/maoyl-blog/assets/js/36.585e21dd.js"><link rel="prefetch" href="/maoyl-blog/assets/js/37.d50c4ae7.js"><link rel="prefetch" href="/maoyl-blog/assets/js/38.8b0a73ec.js"><link rel="prefetch" href="/maoyl-blog/assets/js/39.a584fa18.js"><link rel="prefetch" href="/maoyl-blog/assets/js/4.a5ecb645.js"><link rel="prefetch" href="/maoyl-blog/assets/js/40.c2cf3140.js"><link rel="prefetch" href="/maoyl-blog/assets/js/41.48014a95.js"><link rel="prefetch" href="/maoyl-blog/assets/js/42.8aaa44be.js"><link rel="prefetch" href="/maoyl-blog/assets/js/43.58d01a0c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/44.ffd4cfb5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/45.fe72628d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/46.21111734.js"><link rel="prefetch" href="/maoyl-blog/assets/js/47.bb6b4564.js"><link rel="prefetch" href="/maoyl-blog/assets/js/48.5c644e2a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/49.3cbb474b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/5.77f081fb.js"><link rel="prefetch" href="/maoyl-blog/assets/js/50.3a91f644.js"><link rel="prefetch" href="/maoyl-blog/assets/js/51.9b2dfd72.js"><link rel="prefetch" href="/maoyl-blog/assets/js/52.fd8d5867.js"><link rel="prefetch" href="/maoyl-blog/assets/js/53.9665841a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/54.d96ca7dc.js"><link rel="prefetch" href="/maoyl-blog/assets/js/55.fab9263b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/56.ee4a2d81.js"><link rel="prefetch" href="/maoyl-blog/assets/js/57.187be56a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/58.a88a17f3.js"><link rel="prefetch" href="/maoyl-blog/assets/js/59.4574ee65.js"><link rel="prefetch" href="/maoyl-blog/assets/js/6.31c9cd10.js"><link rel="prefetch" href="/maoyl-blog/assets/js/60.7789848c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/61.54941987.js"><link rel="prefetch" href="/maoyl-blog/assets/js/62.bf4237c5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/63.cd2da040.js"><link rel="prefetch" href="/maoyl-blog/assets/js/64.f5b11713.js"><link rel="prefetch" href="/maoyl-blog/assets/js/65.aee1f42f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/66.4f0aa598.js"><link rel="prefetch" href="/maoyl-blog/assets/js/67.492d7d6c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/68.e4ac271e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/69.38a8b108.js"><link rel="prefetch" href="/maoyl-blog/assets/js/7.0f79063e.js"><link rel="prefetch" href="/maoyl-blog/assets/js/70.7098a678.js"><link rel="prefetch" href="/maoyl-blog/assets/js/71.95c24c40.js"><link rel="prefetch" href="/maoyl-blog/assets/js/72.f801f286.js"><link rel="prefetch" href="/maoyl-blog/assets/js/73.df2e6d4b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/74.8a367987.js"><link rel="prefetch" href="/maoyl-blog/assets/js/75.64a41ea5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/76.9c018f09.js"><link rel="prefetch" href="/maoyl-blog/assets/js/77.41ccc44d.js"><link rel="prefetch" href="/maoyl-blog/assets/js/78.be96bfb0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/79.d036e516.js"><link rel="prefetch" href="/maoyl-blog/assets/js/8.a28d186c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/80.9a832bd6.js"><link rel="prefetch" href="/maoyl-blog/assets/js/81.2fc24328.js"><link rel="prefetch" href="/maoyl-blog/assets/js/82.50fadc21.js"><link rel="prefetch" href="/maoyl-blog/assets/js/83.f996a798.js"><link rel="prefetch" href="/maoyl-blog/assets/js/84.236a2280.js"><link rel="prefetch" href="/maoyl-blog/assets/js/85.4805a82f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/86.fa2f7f63.js"><link rel="prefetch" href="/maoyl-blog/assets/js/87.7b2ce8a4.js"><link rel="prefetch" href="/maoyl-blog/assets/js/88.21844be0.js"><link rel="prefetch" href="/maoyl-blog/assets/js/89.4ecb0d4c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/9.fdb2f626.js"><link rel="prefetch" href="/maoyl-blog/assets/js/90.49e3d42a.js"><link rel="prefetch" href="/maoyl-blog/assets/js/91.7769b395.js"><link rel="prefetch" href="/maoyl-blog/assets/js/92.a6e6d4f5.js"><link rel="prefetch" href="/maoyl-blog/assets/js/93.5307a66c.js"><link rel="prefetch" href="/maoyl-blog/assets/js/94.b39fcfc1.js"><link rel="prefetch" href="/maoyl-blog/assets/js/95.15e4ab83.js"><link rel="prefetch" href="/maoyl-blog/assets/js/96.57058e1f.js"><link rel="prefetch" href="/maoyl-blog/assets/js/97.b36d81ec.js"><link rel="prefetch" href="/maoyl-blog/assets/js/98.9a9f2b7b.js"><link rel="prefetch" href="/maoyl-blog/assets/js/99.351bb4ec.js">
    <link rel="stylesheet" href="/maoyl-blog/assets/css/0.styles.f1c5246f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/maoyl-blog/" class="home-link router-link-active"><img src="/maoyl-blog/img/maoyl-logo.png" alt="Maoyl's blog" class="logo"> <span class="site-name can-hide">Maoyl's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/maoyl-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/maoyl-blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/979248/" class="nav-link">CSS动画</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript文章</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/9f15c1a281d8bedb/" class="nav-link">stylus</a></li></ul></li><li class="dropdown-item"><h4>性能优化</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/node/performance-optimization/" class="nav-link">《性能优化》笔记</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/js/" class="nav-link">《JavaScript高级程序设计》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/es6/" class="nav-link">《ES6 教程》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/design-patterns/" class="nav-link">《JavaScript设计模式》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/51afd6/" class="nav-link">TypeScript笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/4643cd/" class="nav-link">JS设计模式总结笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/maoyl-blog/framework/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/pages/vuejs/" class="nav-link">Vue相关</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/react/" class="nav-link">React相关</a></li></ul></li><li class="dropdown-item"><h4>前端监控</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/monitoring/profile/" class="nav-link">前端监控简介</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/react/" class="nav-link">《React》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/wx-miniprogram/" class="nav-link">小程序学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/maoyl-blog/serve/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/DataStructure/" class="nav-link">数据结构</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/maoyl-blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/21e023/" class="nav-link">网页性能</a></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/git/" class="nav-link">《Git》学习笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/vim/" class="nav-link">《Vim》学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/maoyl-blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/maoyl-blog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/maoyl-blog/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/maoyl-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/maoyln/maoyl-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/maoyln/maoyl-img/blog/my-head.jpeg"> <div class="blogger-info"><h3>maoyln</h3> <span>日日行，不怕千万里</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/maoyl-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/maoyl-blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/979248/" class="nav-link">CSS动画</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript文章</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/9f15c1a281d8bedb/" class="nav-link">stylus</a></li></ul></li><li class="dropdown-item"><h4>性能优化</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/node/performance-optimization/" class="nav-link">《性能优化》笔记</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/js/" class="nav-link">《JavaScript高级程序设计》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/es6/" class="nav-link">《ES6 教程》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/design-patterns/" class="nav-link">《JavaScript设计模式》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/51afd6/" class="nav-link">TypeScript笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/4643cd/" class="nav-link">JS设计模式总结笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/maoyl-blog/framework/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/pages/vuejs/" class="nav-link">Vue相关</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/pages/react/" class="nav-link">React相关</a></li></ul></li><li class="dropdown-item"><h4>前端监控</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/monitoring/profile/" class="nav-link">前端监控简介</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/react/" class="nav-link">《React》笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/wx-miniprogram/" class="nav-link">小程序学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/maoyl-blog/serve/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/DataStructure/" class="nav-link">数据结构</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/maoyl-blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/21e023/" class="nav-link">网页性能</a></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maoyl-blog/note/git/" class="nav-link">《Git》学习笔记</a></li><li class="dropdown-subitem"><a href="/maoyl-blog/note/vim/" class="nav-link">《Vim》学习笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/maoyl-blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/maoyl-blog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/maoyl-blog/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/maoyl-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/maoyl-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/maoyl-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/maoyln/maoyl-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/maoyl-blog/pages/f344d070a1031ef7/" class="sidebar-link">ECMAScript 6 简介</a></li><li><a href="/maoyl-blog/pages/c1edd70a6b7c7872/" class="sidebar-link">let 和 const 命令</a></li><li><a href="/maoyl-blog/pages/b1ab10a62f7564da/" class="sidebar-link">变量的解构赋值</a></li><li><a href="/maoyl-blog/pages/ca89eca8adeba5f4/" class="sidebar-link">字符串的扩展</a></li><li><a href="/maoyl-blog/pages/a650b4a0ebfc9350/" class="sidebar-link">字符串的新增方法</a></li><li><a href="/maoyl-blog/pages/0473261a6ab0ee8c/" class="sidebar-link">正则的扩展</a></li><li><a href="/maoyl-blog/pages/5dfea9a0f2d1a392/" class="sidebar-link">数值的扩展</a></li><li><a href="/maoyl-blog/pages/8ed309d668b20264/" class="sidebar-link">函数的扩展</a></li><li><a href="/maoyl-blog/pages/e34009d60d8bc4b2/" class="sidebar-link">数组的扩展</a></li><li><a href="/maoyl-blog/pages/b5e3e0a0ff6e9c25/" class="sidebar-link">对象的扩展</a></li><li><a href="/maoyl-blog/pages/e85e68947502cf90/" class="sidebar-link">对象的新增方法</a></li><li><a href="/maoyl-blog/pages/02c86eb2792f3262/" class="sidebar-link">Symbol</a></li><li><a href="/maoyl-blog/pages/0c21dae358fca16b/" class="sidebar-link">Set 和 Map 数据结构</a></li><li><a href="/maoyl-blog/pages/f56ec2ab97d60483/" class="sidebar-link">Proxy</a></li><li><a href="/maoyl-blog/pages/74de3e45e4491e95/" class="sidebar-link">Reflect</a></li><li><a href="/maoyl-blog/pages/2810ae8985e9bd52/" class="sidebar-link">Promise 对象</a></li><li><a href="/maoyl-blog/pages/48df907ad3570f3d/" aria-current="page" class="active sidebar-link">Iterator 和 for-of 循环</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#iterator-遍历器-的概念" class="sidebar-link">Iterator（遍历器）的概念</a></li><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#默认-iterator-接口" class="sidebar-link">默认 Iterator 接口</a></li><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#调用-iterator-接口的场合" class="sidebar-link">调用 Iterator 接口的场合</a></li><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#字符串的-iterator-接口" class="sidebar-link">字符串的 Iterator 接口</a></li><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#iterator-接口与-generator-函数" class="sidebar-link">Iterator 接口与 Generator 函数</a></li><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#遍历器对象的-return-throw" class="sidebar-link">遍历器对象的 return()，throw()</a></li><li class="sidebar-sub-header level2"><a href="/maoyl-blog/pages/48df907ad3570f3d/#for-of-循环" class="sidebar-link">for...of 循环</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/maoyl-blog/pages/48df907ad3570f3d/#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header level3"><a href="/maoyl-blog/pages/48df907ad3570f3d/#set-和-map-结构" class="sidebar-link">Set 和 Map 结构</a></li><li class="sidebar-sub-header level3"><a href="/maoyl-blog/pages/48df907ad3570f3d/#计算生成的数据结构" class="sidebar-link">计算生成的数据结构</a></li><li class="sidebar-sub-header level3"><a href="/maoyl-blog/pages/48df907ad3570f3d/#类似数组的对象" class="sidebar-link">类似数组的对象</a></li><li class="sidebar-sub-header level3"><a href="/maoyl-blog/pages/48df907ad3570f3d/#对象" class="sidebar-link">对象</a></li><li class="sidebar-sub-header level3"><a href="/maoyl-blog/pages/48df907ad3570f3d/#与其他遍历语法的比较" class="sidebar-link">与其他遍历语法的比较</a></li></ul></li></ul></li><li><a href="/maoyl-blog/pages/718b48ed9ce0adce/" class="sidebar-link">Generator 函数的语法</a></li><li><a href="/maoyl-blog/pages/75af7031eb66847b/" class="sidebar-link">Generator 函数的异步应用</a></li><li><a href="/maoyl-blog/pages/3777253e65bac487/" class="sidebar-link">async 函数</a></li><li><a href="/maoyl-blog/pages/e831e1593c82bbe0/" class="sidebar-link">Class 的基本语法</a></li><li><a href="/maoyl-blog/pages/83f8c3a0cd87dd83/" class="sidebar-link">Class 的继承</a></li><li><a href="/maoyl-blog/pages/efe2fb04eb8ac5fb/" class="sidebar-link">Module 的语法</a></li><li><a href="/maoyl-blog/pages/a79ca2e64ceae213/" class="sidebar-link">Module 的加载实现</a></li><li><a href="/maoyl-blog/pages/984bf549204bb266/" class="sidebar-link">编程风格</a></li><li><a href="/maoyl-blog/pages/32c35f7651d6e58e/" class="sidebar-link">读懂 ECMAScript 规格</a></li><li><a href="/maoyl-blog/pages/16121351be68691b/" class="sidebar-link">异步遍历器</a></li><li><a href="/maoyl-blog/pages/a2ba314746bfdbdd/" class="sidebar-link">ArrayBuffer</a></li><li><a href="/maoyl-blog/pages/7188882b8d65af1b/" class="sidebar-link">最新提案</a></li><li><a href="/maoyl-blog/pages/e97bc1e5626b082c/" class="sidebar-link">装饰器</a></li><li><a href="/maoyl-blog/pages/1cf50330655efc69/" class="sidebar-link">函数式编程</a></li><li><a href="/maoyl-blog/pages/6a8e2dc558da1b39/" class="sidebar-link">Mixin</a></li><li><a href="/maoyl-blog/pages/8e8f80f69b775a56/" class="sidebar-link">SIMD</a></li><li><a href="/maoyl-blog/pages/ea6f3b870f6dab69/" class="sidebar-link">参考链接</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/maoyl-blog/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/maoyl-blog/note/es6/#《ES6 教程》笔记" data-v-06225672>《ES6 教程》笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/maoyln" target="_blank" title="作者" class="beLink" data-v-06225672>maoyln</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2020-02-09</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Iterator 和 for-of 循环<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="iterator-和-for-of-循环"><a href="#iterator-和-for-of-循环" class="header-anchor">#</a> Iterator 和 for...of 循环</h1> <h2 id="iterator-遍历器-的概念"><a href="#iterator-遍历器-的概念" class="header-anchor">#</a> Iterator（遍历器）的概念</h2> <p>JavaScript 原有的表示“集合”的数据结构，主要是数组（<code>Array</code>）和对象（<code>Object</code>），ES6 又添加了<code>Map</code>和<code>Set</code>。这样就有了四种数据集合，用户还可以组合使用它们，定义自己的数据结构，比如数组的成员是<code>Map</code>，<code>Map</code>的成员是对象。这样就需要一种统一的接口机制，来处理所有不同的数据结构。

遍历器（Iterator）就是这样一种机制。<strong>它是一种接口，为各种不同的数据结构提供统一的访问机制</strong>。<strong>任何数据结构只要部署 Iterator 接口，就可以完成遍历操作</strong>（即依次处理该数据结构的所有成员）。</p> <p>Iterator 的作用有三个：一是为各种数据结构，提供一个统一的、简便的访问接口；二是使得数据结构的成员能够按某种次序排列；三是 ES6 创造了一种新的遍历命令<code>for...of</code>循环，Iterator 接口主要供<code>for...of</code>消费。</p> <p>Iterator 的遍历过程是这样的。</p> <p>（1）创建一个指针对象，指向当前数据结构的起始位置。也就是说，遍历器对象本质上，就是一个指针对象。</p> <p>（2）第一次调用指针对象的<code>next</code>方法，可以将指针指向数据结构的第一个成员。</p> <p>（3）第二次调用指针对象的<code>next</code>方法，指针就指向数据结构的第二个成员。</p> <p>（4）不断调用指针对象的<code>next</code>方法，直到它指向数据结构的结束位置。</p> <p>每一次调用<code>next</code>方法，都会返回数据结构的当前成员的信息。具体来说，就是返回一个包含<code>value</code>和<code>done</code>两个属性的对象。其中，<code>value</code>属性是当前成员的值，<code>done</code>属性是一个布尔值，表示遍历是否结束。</p> <p>下面是一个模拟<code>next</code>方法返回值的例子。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> it <span class="token operator">=</span> <span class="token function">makeIterator</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: &quot;a&quot;, done: false }</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: &quot;b&quot;, done: false }</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: undefined, done: true }</span>

<span class="token keyword">function</span> <span class="token function">makeIterator</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> nextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> nextIndex <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length <span class="token operator">?</span>
        <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> array<span class="token punctuation">[</span>nextIndex<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token operator">:</span>
        <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>上面代码定义了一个<code>makeIterator</code>函数，它是一个遍历器生成函数，作用就是返回一个遍历器对象。对数组<code>['a', 'b']</code>执行这个函数，就会返回该数组的遍历器对象（即指针对象）<code>it</code>。</p> <p>指针对象的<code>next</code>方法，用来移动指针。开始时，指针指向数组的开始位置。然后，每次调用<code>next</code>方法，指针就会指向数组的下一个成员。第一次调用，指向<code>a</code>；第二次调用，指向<code>b</code>。</p> <p><code>next</code>方法返回一个对象，表示当前数据成员的信息。这个对象具有<code>value</code>和<code>done</code>两个属性，<code>value</code>属性返回当前位置的成员，<code>done</code>属性是一个布尔值，表示遍历是否结束，即是否还有必要再一次调用<code>next</code>方法。</p> <p>总之，调用指针对象的<code>next</code>方法，就可以遍历事先给定的数据结构。</p> <p>对于遍历器对象来说，<code>done: false</code>和<code>value: undefined</code>属性都是可以省略的，因此上面的<code>makeIterator</code>函数可以简写成下面的形式。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeIterator</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> nextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> nextIndex <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length <span class="token operator">?</span>
        <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> array<span class="token punctuation">[</span>nextIndex<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token operator">:</span>
        <span class="token punctuation">{</span><span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>由于 Iterator 只是把接口规格加到数据结构之上，所以，遍历器与它所遍历的那个数据结构，实际上是分开的，完全可以写出没有对应数据结构的遍历器对象，或者说用遍历器对象模拟出数据结构。下面是一个无限运行的遍历器对象的例子。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> it <span class="token operator">=</span> <span class="token function">idMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token comment">// 0</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token comment">// 1</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token comment">// 2</span>
<span class="token comment">// ...</span>

<span class="token keyword">function</span> <span class="token function">idMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> index<span class="token operator">++</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>上面的例子中，遍历器生成函数<code>idMaker</code>，返回一个遍历器对象（即指针对象）。但是并没有对应的数据结构，或者说，遍历器对象自己描述了一个数据结构出来。</p> <p>如果使用 TypeScript 的写法，遍历器接口（Iterable）、指针对象（Iterator）和<code>next</code>方法返回值的规格可以描述如下。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">Iterable</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Iterator<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Iterator</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token operator">:</span> IterationResult<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IterationResult</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  <span class="token literal-property property">done</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="默认-iterator-接口"><a href="#默认-iterator-接口" class="header-anchor">#</a> 默认 Iterator 接口</h2> <p>I<strong>terator 接口的目的，就是为所有数据结构，提供了一种统一的访问机制，即<code>for...of</code>循环（详见下文）</strong>。当使用<code>for...of</code>循环遍历某种数据结构时，该循环会自动去寻找 Iterator 接口。</p> <p><strong>一种数据结构只要部署了 Iterator 接口，我们就称这种数据结构是“可遍历的”</strong>（iterable）。</p> <p>ES6 规定，<strong>默认的 Iterator 接口部署在数据结构的<code>Symbol.iterator</code>属性</strong>，或者说，一个数据结构只要具有<code>Symbol.iterator</code>属性，就可以认为是“可遍历的”（iterable）。<code>Symbol.iterator</code>属性本身是一个函数，就是当前数据结构默认的遍历器生成函数。执行这个函数，就会返回一个遍历器。至于属性名<code>Symbol.iterator</code>，它是一个表达式，返回<code>Symbol</code>对象的<code>iterator</code>属性，这是一个预定义好的、类型为 Symbol 的特殊值，所以要放在方括号内（参见《Symbol》一章）。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>上面代码中，对象<code>obj</code>是可遍历的（iterable），因为具有<code>Symbol.iterator</code>属性。执行这个属性，会返回一个遍历器对象。该对象的根本特征就是具有<code>next</code>方法。每次调用<code>next</code>方法，都会返回一个代表当前成员的信息对象，具有<code>value</code>和<code>done</code>两个属性。</p> <p>ES6 的有些数据结构原生具备 Iterator 接口（比如数组），即不用任何处理，就可以被<code>for...of</code>循环遍历。原因在于，这些数据结构原生部署了<code>Symbol.iterator</code>属性（详见下文），另外一些数据结构没有（比如对象）。凡是部署了<code>Symbol.iterator</code>属性的数据结构，就称为部署了遍历器接口。调用这个接口，就会返回一个遍历器对象。</p> <p><strong>原生具备 Iterator 接口的数据结构如下。</strong></p> <ul><li>Array</li> <li>Map</li> <li>Set</li> <li>String</li> <li>TypedArray</li> <li>函数的 arguments 对象</li> <li>NodeList 对象</li></ul> <p>下面的例子是数组的<code>Symbol.iterator</code>属性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> iter <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 'a', done: false }</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 'b', done: false }</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 'c', done: false }</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: undefined, done: true }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面代码中，变量<code>arr</code>是一个数组，原生就具有遍历器接口，部署在<code>arr</code>的<code>Symbol.iterator</code>属性上面。所以，调用这个属性，就得到遍历器对象。</p> <p>对于原生部署 Iterator 接口的数据结构，不用自己写遍历器生成函数，<code>for...of</code>循环会自动遍历它们。除此之外，其他数据结构（主要是对象）的 Iterator 接口，都需要自己在<code>Symbol.iterator</code>属性上面部署，这样才会被<code>for...of</code>循环遍历。</p> <p>对象（Object）之所以没有默认部署 Iterator 接口，是因为对象的哪个属性先遍历，哪个属性后遍历是不确定的，需要开发者手动指定。本质上，遍历器是一种线性处理，对于任何非线性的数据结构，部署遍历器接口，就等于部署一种线性转换。不过，严格地说，对象部署遍历器接口并不是很必要，因为这时对象实际上被当作 Map 结构使用，ES5 没有 Map 结构，而 ES6 原生提供了。</p> <p>一个对象如果要具备可被<code>for...of</code>循环调用的 Iterator 接口，就必须在<code>Symbol.iterator</code>的属性上部署遍历器生成方法（原型链上的对象具有该方法也可）。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">RangeIterator</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span> stop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> start<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stop <span class="token operator">=</span> stop<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> value<span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span> stop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RangeIterator</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> value <span class="token keyword">of</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0, 1, 2</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>上面代码是一个类部署 Iterator 接口的写法。<code>Symbol.iterator</code>属性对应一个函数，执行后返回当前对象的遍历器对象。</p> <p>下面是通过遍历器实现指针结构的例子。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Obj</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Obj</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">next</span><span class="token operator">:</span> next <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> value <span class="token operator">=</span> current<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      current <span class="token operator">=</span> current<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> iterator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> one <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> two <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> three <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

one<span class="token punctuation">.</span>next <span class="token operator">=</span> two<span class="token punctuation">;</span>
two<span class="token punctuation">.</span>next <span class="token operator">=</span> three<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">of</span> one<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1, 2, 3</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>上面代码首先在构造函数的原型链上部署<code>Symbol.iterator</code>方法，调用该方法会返回遍历器对象<code>iterator</code>，调用该对象的<code>next</code>方法，在返回一个值的同时，自动将内部指针移到下一个实例。</p> <p>下面是另一个为对象添加 Iterator 接口的例子。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'world'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>对于类似数组的对象（存在数值键名和<code>length</code>属性），部署 Iterator 接口，有一个简便方法，就是<code>Symbol.iterator</code>方法直接引用数组的 Iterator 接口。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">NodeList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 或者</span>
<span class="token class-name">NodeList</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">// 可以执行了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>NodeList 对象是类似数组的对象，本来就具有遍历接口，可以直接遍历。上面代码中，我们将它的遍历接口改成数组的<code>Symbol.iterator</code>属性，可以看到没有任何影响。</p> <p>下面是另一个<strong>类似数组的对象调用数组的<code>Symbol.iterator</code>方法的例子</strong>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> iterable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> iterable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'a', 'b', 'c'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注意，<strong>普通对象部署数组的<code>Symbol.iterator</code>方法，并无效果</strong>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> iterable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> iterable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined, undefined, undefined</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如果<code>Symbol.iterator</code>方法对应的不是遍历器生成函数（即会返回一个遍历器对象），解释引擎将会报错。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span> <span class="token comment">// TypeError: [] is not a function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面代码中，变量<code>obj</code>的<code>Symbol.iterator</code>方法对应的不是遍历器生成函数，因此报错。</p> <p>有了遍历器接口，数据结构就可以用<code>for...of</code>循环遍历（详见下文），也可以使用<code>while</code>循环遍历。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> $iterator <span class="token operator">=</span> <span class="token constant">ITERABLE</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> $result <span class="token operator">=</span> $iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>$result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> x <span class="token operator">=</span> $result<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
  $result <span class="token operator">=</span> $iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面代码中，<code>ITERABLE</code>代表某种可遍历的数据结构，<code>$iterator</code>是它的遍历器对象。遍历器对象每次移动指针（<code>next</code>方法），都检查一下返回值的<code>done</code>属性，如果遍历还没结束，就移动遍历器对象的指针到下一步（<code>next</code>方法），不断循环。</p> <h2 id="调用-iterator-接口的场合"><a href="#调用-iterator-接口的场合" class="header-anchor">#</a> 调用 Iterator 接口的场合</h2> <p>有一些场合会默认调用 Iterator 接口（即<code>Symbol.iterator</code>方法），除了下文会介绍的<code>for...of</code>循环，还有几个别的场合。</p> <p><strong>（1）解构赋值</strong></p> <p>对数组和 Set 结构进行解构赋值时，会默认调用<code>Symbol.iterator</code>方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> set<span class="token punctuation">;</span>
<span class="token comment">// x='a'; y='b'</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> set<span class="token punctuation">;</span>
<span class="token comment">// first='a'; rest=['b','c'];</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>（2）扩展运算符</strong></p> <p>扩展运算符（...）也会调用默认的 Iterator 接口。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 例一</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token operator">...</span>str<span class="token punctuation">]</span> <span class="token comment">//  ['h','e','l','l','o']</span>

<span class="token comment">// 例二</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token operator">...</span>arr<span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span>
<span class="token comment">// ['a', 'b', 'c', 'd']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上面代码的扩展运算符内部就调用 Iterator 接口。</p> <p>实际上，这提供了一种简便机制，可以将任何部署了 Iterator 接口的数据结构，转为数组。也就是说，<strong>只要某个数据结构部署了 Iterator 接口，就可以对它使用扩展运算符，将其转为数组</strong>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>iterable<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>（3）yield*</strong></p> <p><code>yield*</code>后面跟的是一个可遍历的结构，它会调用该结构的遍历器接口。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token function-variable function">generator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 1, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 2, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 3, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 4, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: 5, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { value: undefined, done: true }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>（4）其他场合</strong></p> <p>由于数组的遍历会调用遍历器接口，所以任何接受数组作为参数的场合，其实都调用了遍历器接口。下面是一些例子。</p> <ul><li>for...of</li> <li>Array.from()</li> <li>Map(), Set(), WeakMap(), WeakSet()（比如<code>new Map([['a',1],['b',2]])</code>）</li> <li>Promise.all()</li> <li>Promise.race()</li></ul> <h2 id="字符串的-iterator-接口"><a href="#字符串的-iterator-接口" class="header-anchor">#</a> 字符串的 Iterator 接口</h2> <p><strong>字符串是一个类似数组的对象，也原生具有 Iterator 接口</strong>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> someString <span class="token operator">=</span> <span class="token string">&quot;hi&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">typeof</span> someString<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span>
<span class="token comment">// &quot;function&quot;</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> someString<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// { value: &quot;h&quot;, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// { value: &quot;i&quot;, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// { value: undefined, done: true }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上面代码中，调用<code>Symbol.iterator</code>方法返回一个遍历器对象，在这个遍历器上可以调用 next 方法，实现对于字符串的遍历。</p> <p>可以覆盖原生的<code>Symbol.iterator</code>方法，达到修改遍历器行为的目的。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span>str<span class="token punctuation">]</span> <span class="token comment">// [&quot;h&quot;, &quot;i&quot;]</span>

str<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_first <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;bye&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">_first</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span>str<span class="token punctuation">]</span> <span class="token comment">// [&quot;bye&quot;]</span>
str <span class="token comment">// &quot;hi&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>上面代码中，字符串 str 的<code>Symbol.iterator</code>方法被修改了，所以扩展运算符（<code>...</code>）返回的值变成了<code>bye</code>，而字符串本身还是<code>hi</code>。</p> <h2 id="iterator-接口与-generator-函数"><a href="#iterator-接口与-generator-函数" class="header-anchor">#</a> Iterator 接口与 Generator 函数</h2> <p><code>Symbol.iterator</code>方法的最简单实现，还是使用下一章要介绍的 Generator 函数。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> myIterable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">[</span><span class="token operator">...</span>myIterable<span class="token punctuation">]</span> <span class="token comment">// [1, 2, 3]</span>

<span class="token comment">// 或者采用下面的简洁写法</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">*</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token string">'world'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// &quot;hello&quot;</span>
<span class="token comment">// &quot;world&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>上面代码中，<code>Symbol.iterator</code>方法几乎不用部署任何代码，只要用 yield 命令给出每一步的返回值即可。</p> <h2 id="遍历器对象的-return-throw"><a href="#遍历器对象的-return-throw" class="header-anchor">#</a> 遍历器对象的 return()，throw()</h2> <p>遍历器对象除了具有<code>next</code>方法，还可以具有<code>return</code>方法和<code>throw</code>方法。如果你自己写遍历器对象生成函数，那么<code>next</code>方法是必须部署的，<code>return</code>方法和<code>throw</code>方法是否部署是可选的。</p> <p><code>return</code>方法的使用场合是，如果<code>for...of</code>循环提前退出（通常是因为出错，或者有<code>break</code>语句），就会调用<code>return</code>方法。如果一个对象在完成遍历前，需要清理或释放资源，就可以部署<code>return</code>方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">readLinesSync</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>上面代码中，函数<code>readLinesSync</code>接受一个文件对象作为参数，返回一个遍历器对象，其中除了<code>next</code>方法，还部署了<code>return</code>方法。下面的两种情况，都会触发执行<code>return</code>方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 情况一</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> line <span class="token keyword">of</span> <span class="token function">readLinesSync</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 情况二</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> line <span class="token keyword">of</span> <span class="token function">readLinesSync</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上面代码中，情况一输出文件的第一行以后，就会执行<code>return</code>方法，关闭这个文件；情况二会在执行<code>return</code>方法关闭文件之后，再抛出错误。</p> <p>注意，<code>return</code>方法必须返回一个对象，这是 Generator 规格决定的。</p> <p><code>throw</code>方法主要是配合 Generator 函数使用，一般的遍历器对象用不到这个方法。请参阅《Generator 函数》一章。</p> <h2 id="for-of-循环"><a href="#for-of-循环" class="header-anchor">#</a> for...of 循环</h2> <p>ES6 借鉴 C++、Java、C# 和 Python 语言，引入了<code>for...of</code>循环，<strong>作为遍历所有数据结构的统一的方法</strong>。</p> <p>一个数据结构只要部署了<code>Symbol.iterator</code>属性，就被视为具有 iterator 接口，就可以用<code>for...of</code>循环遍历它的成员。也就是说，<strong><code>for...of</code>循环内部调用的是数据结构的<code>Symbol.iterator</code>方法</strong>。</p> <p><code>for...of</code>循环可以使用的范围包括<strong>数组、Set 和 Map 结构、某些类似数组的对象（比如<code>arguments</code>对象、DOM NodeList 对象）、后文的 Generator 对象，以及字符串。</strong></p> <h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <p>数组原生具备<code>iterator</code>接口（即默认部署了<code>Symbol.iterator</code>属性），<code>for...of</code>循环本质上就是调用这个接口产生的遍历器，可以用下面的代码证明。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> v <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// red green blue</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> v <span class="token keyword">of</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// red green blue</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>上面代码中，空对象<code>obj</code>部署了数组<code>arr</code>的<code>Symbol.iterator</code>属性，结果<code>obj</code>的<code>for...of</code>循环，产生了与<code>arr</code>完全一样的结果。</p> <p><code>for...of</code>循环可以代替数组实例的<code>forEach</code>方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// red green blue</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 0 1 2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>JavaScript 原有的**<code>for...in</code>循环，只能获得对象的键名**，不能直接获取键值。ES6 提供<code>for...of</code>循环，允许遍历获得键值。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> a <span class="token keyword">in</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 1 2 3</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> a <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a b c d</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上面代码表明，<strong><code>for...in</code>循环读取键名，<code>for...of</code>循环读取键值</strong>。如果要通过<code>for...of</code>循环，获取数组的索引，可以借助数组实例的<code>entries</code>方法和<code>keys</code>方法（参见《数组的扩展》一章）。</p> <p><code>for...of</code>循环调用遍历器接口，数组的遍历器接口只返回具有数字索引的属性。这一点跟<code>for...in</code>循环也不一样。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;foo&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  &quot;3&quot;, &quot;5&quot;, &quot;7&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>上面代码中，<code>for...of</code>循环不会返回数组<code>arr</code>的<code>foo</code>属性。</p> <h3 id="set-和-map-结构"><a href="#set-和-map-结构" class="header-anchor">#</a> Set 和 Map 结构</h3> <p>Set 和 Map 结构也原生具有 Iterator 接口，可以直接使用<code>for...of</code>循环。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> engines <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Gecko&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Trident&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Webkit&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Webkit&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> e <span class="token keyword">of</span> engines<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Gecko</span>
<span class="token comment">// Trident</span>
<span class="token comment">// Webkit</span>

<span class="token keyword">var</span> es6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
es6<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;edition&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
es6<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;committee&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TC39&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
es6<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ECMA-262&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> es6<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// edition: 6</span>
<span class="token comment">// committee: TC39</span>
<span class="token comment">// standard: ECMA-262</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>上面代码演示了如何遍历 Set 结构和 Map 结构。值得注意的地方有两个，首先，遍历的顺序是按照各个成员被添加进数据结构的顺序。其次，Set 结构遍历时，返回的是一个值，而 Map 结构遍历时，返回的是一个数组，该数组的两个成员分别为当前 Map 成员的键名和键值。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> pair <span class="token keyword">of</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ['a', 1]</span>
<span class="token comment">// ['b', 2]</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">' : '</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// a : 1</span>
<span class="token comment">// b : 2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="计算生成的数据结构"><a href="#计算生成的数据结构" class="header-anchor">#</a> 计算生成的数据结构</h3> <p>有些数据结构是在现有数据结构的基础上，计算生成的。比如，ES6 的数组、Set、Map 都部署了以下三个方法，调用后都返回遍历器对象。</p> <ul><li><code>entries()</code> 返回一个遍历器对象，用来遍历<code>[键名, 键值]</code>组成的数组。对于数组，键名就是索引值；对于 Set，键名与键值相同。Map 结构的 Iterator 接口，默认就是调用<code>entries</code>方法。</li> <li><code>keys()</code> 返回一个遍历器对象，用来遍历所有的键名。</li> <li><code>values()</code> 返回一个遍历器对象，用来遍历所有的键值。</li></ul> <p>这三个方法调用后生成的遍历器对象，所遍历的都是计算生成的数据结构。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> pair <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// [0, 'a']</span>
<span class="token comment">// [1, 'b']</span>
<span class="token comment">// [2, 'c']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="类似数组的对象"><a href="#类似数组的对象" class="header-anchor">#</a> 类似数组的对象</h3> <p>类似数组的对象包括好几类。下面是<code>for...of</code>循环用于字符串、DOM NodeList 对象、<code>arguments</code>对象的例子。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 字符串</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> s <span class="token keyword">of</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// h e l l o</span>
<span class="token punctuation">}</span>

<span class="token comment">// DOM NodeList对象</span>
<span class="token keyword">let</span> paras <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> p <span class="token keyword">of</span> paras<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  p<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// arguments对象</span>
<span class="token keyword">function</span> <span class="token function">printArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> arguments<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">printArgs</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'a'</span>
<span class="token comment">// 'b'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>对于字符串来说，<code>for...of</code>循环还有一个特点，就是会正确识别 32 位 UTF-16 字符。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> <span class="token string">'a\uD83D\uDC0A'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 'a'</span>
<span class="token comment">// '\uD83D\uDC0A'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>并不是所有类似数组的对象都具有 Iterator 接口，一个简便的解决方法，就是使用<code>Array.from</code>方法将其转为数组。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> arrayLike <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'b'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 报错</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> arrayLike<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 正确</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="对象"><a href="#对象" class="header-anchor">#</a> 对象</h3> <p>对于普通的对象，<code>for...of</code>结构不能直接使用，会报错，必须部署了 Iterator 接口后才能使用。但是，这样情况下，<code>for...in</code>循环依然可以用来遍历键名。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> es6 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">edition</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
  <span class="token literal-property property">committee</span><span class="token operator">:</span> <span class="token string">&quot;TC39&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">standard</span><span class="token operator">:</span> <span class="token string">&quot;ECMA-262&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> e <span class="token keyword">in</span> es6<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// edition</span>
<span class="token comment">// committee</span>
<span class="token comment">// standard</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> e <span class="token keyword">of</span> es6<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// TypeError: es6[Symbol.iterator] is not a function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>上面代码表示，对于普通的对象，<code>for...in</code>循环可以遍历键名，<code>for...of</code>循环会报错。</p> <p>一种解决方法是，使用<code>Object.keys</code>方法将对象的键名生成一个数组，然后遍历这个数组。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>someObject<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> someObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>另一个方法是使用 Generator 函数将对象重新包装一下。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">entries</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">'-&gt;'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// a -&gt; 1</span>
<span class="token comment">// b -&gt; 2</span>
<span class="token comment">// c -&gt; 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="与其他遍历语法的比较"><a href="#与其他遍历语法的比较" class="header-anchor">#</a> 与其他遍历语法的比较</h3> <p>以数组为例，JavaScript 提供多种遍历语法。最原始的写法就是<code>for</code>循环。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> myArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这种写法比较麻烦，因此数组提供内置的<code>forEach</code>方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>myArray<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这种写法的问题在于，无法中途跳出<code>forEach</code>循环，<code>break</code>命令或<code>return</code>命令都不能奏效。</p> <p><code>for...in</code>循环可以遍历数组的键名。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> index <span class="token keyword">in</span> myArray<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>for...in</code>循环有几个缺点。</p> <ul><li>数组的键名是数字，但是<code>for...in</code>循环是以字符串作为键名“0”、“1”、“2”等等。</li> <li><code>for...in</code>循环不仅遍历数字键名，还会遍历手动添加的其他键，甚至包括原型链上的键。</li> <li>某些情况下，<code>for...in</code>循环会以任意顺序遍历键名。</li></ul> <p>总之，<code>for...in</code>循环主要是为遍历对象而设计的，不适用于遍历数组。</p> <p><code>for...of</code>循环相比上面几种做法，有一些显著的优点。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> myArray<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>有着同<code>for...in</code>一样的简洁语法，但是没有<code>for...in</code>那些缺点。</li> <li>不同于<code>forEach</code>方法，它可以与<code>break</code>、<code>continue</code>和<code>return</code>配合使用。</li> <li>提供了遍历所有数据结构的统一操作接口。</li></ul> <p>下面是一个使用 break 语句，跳出<code>for...of</code>循环的例子。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token keyword">of</span> fibonacci<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面的例子，会输出斐波纳契数列小于等于 1000 的项。如果当前项大于 1000，就会使用<code>break</code>语句跳出<code>for...of</code>循环。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/maoyln/maoyl-blog/edit/master/docs/《ES6 教程》笔记/17.Iterator 和 for-of 循环.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/maoyl-blog/tags/?tag=ES6" title="标签">#ES6</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/09/19, 06:41:22</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/maoyl-blog/pages/2810ae8985e9bd52/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Promise 对象</div></a> <a href="/maoyl-blog/pages/718b48ed9ce0adce/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Generator 函数的语法</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/maoyl-blog/pages/2810ae8985e9bd52/" class="prev">Promise 对象</a></span> <span class="next"><a href="/maoyl-blog/pages/718b48ed9ce0adce/">Generator 函数的语法</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/maoyl-blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/maoyl-blog/pages/aaf9e0/"><div>
            自适应方案PxToRem
            <!----></div></a> <span class="date">09-10</span></dt></dl><dl><dd>02</dd> <dt><a href="/maoyl-blog/pages/d2fd1f/"><div>
            性能优化-requestAnimationFrame
            <!----></div></a> <span class="date">08-10</span></dt></dl><dl><dd>03</dd> <dt><a href="/maoyl-blog/pages/ee30aa/"><div>
            js如何实现当文本内容过长时，中间显示省略号,两端正常展示
            <!----></div></a> <span class="date">07-21</span></dt></dl> <dl><dd></dd> <dt><a href="/maoyl-blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:maoyl_yx@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/maoyln" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/discover/toplist" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>备案号：<a href="https://beian.miit.gov.cn/" target="_blank">京ICP备19058102号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/maoyl-blog/assets/js/app.80208eb3.js" defer></script><script src="/maoyl-blog/assets/js/2.4c6434db.js" defer></script><script src="/maoyl-blog/assets/js/124.56ac94eb.js" defer></script>
  </body>
</html>
